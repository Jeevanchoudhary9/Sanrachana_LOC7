{% extends 'layout.html' %}

{% block title %}
Grocerises - Login
{% endblock %}



{% block content %}
<div class="bg-gradient-to-br from-gray-50 to-gray-100 text-gray-900">
  <!-- Register Content -->
  <div class="min-h-screen flex items-center justify-center">
    <div class="container max-w-auto mx-auto px-4 py-24" data-aos="zoom-in">
      <div class="glass-effect rounded-2xl p-8">
        <div class="flex justify-between items-center mb-6">
          <h3 class="text-2xl font-bold gradient-text">Create Account</h3>
          <a href="{{url_for('index')}}" class="text-gray-500 hover:text-gray-700">&times;</a>
        </div>
        <form class="space-y-4" action="{{url_for('register')}}" method="POST" enctype="multipart/form-data">
          <!-- Credentials Section -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label class="block text-gray-700 mb-2">Username*</label>
              <input type="text" name="username" required 
                     class="w-full px-4 py-3 rounded-lg bg-white border border-gray-200 focus:ring-2 focus:ring-purple-500 focus:border-transparent">
            </div>
            <div>
              <label class="block text-gray-700 mb-2">Full Name*</label>
              <input type="text" name="full_name" required 
                     class="w-full px-4 py-3 rounded-lg bg-white border border-gray-200 focus:ring-2 focus:ring-purple-500 focus:border-transparent">
            </div>
          </div>

          <div>
            <label class="block text-gray-700 mb-2">Email*</label>
            <input type="email" name="email" required 
                   class="w-full px-4 py-3 rounded-lg bg-white border border-gray-200 focus:ring-2 focus:ring-purple-500 focus:border-transparent">
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label class="block text-gray-700 mb-2">Password*</label>
              <input type="password" name="password" required 
                     class="w-full px-4 py-3 rounded-lg bg-white border border-gray-200 focus:ring-2 focus:ring-purple-500 focus:border-transparent">
            </div>
            <div>
              <label class="block text-gray-700 mb-2">Confirm Password*</label>
              <input type="password" name="confirm_password" required 
                     class="w-full px-4 py-3 rounded-lg bg-white border border-gray-200 focus:ring-2 focus:ring-purple-500 focus:border-transparent">
            </div>
          </div>

          <!-- Organization Details -->
          <div>
            <label class="block text-gray-700 mb-2">Organization Name*</label>
            <input type="text" name="organization_name" required 
                   class="w-full px-4 py-3 rounded-lg bg-white border border-gray-200 focus:ring-2 focus:ring-purple-500 focus:border-transparent">
          </div>

          <div>
            <label class="block text-gray-700 mb-2">Motto*</label>
            <input type="text" name="motto" required 
                   class="w-full px-4 py-3 rounded-lg bg-white border border-gray-200 focus:ring-2 focus:ring-purple-500 focus:border-transparent">
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label class="block text-gray-700 mb-2">Date of Creation*</label>
              <input type="date" name="date_of_creation" required 
                     class="w-full px-4 py-3 rounded-lg bg-white border border-gray-200 focus:ring-2 focus:ring-purple-500 focus:border-transparent">
            </div>
            <div>
              
              <div>
                <label class="block text-gray-700 mb-2">Organization Logo</label>
                <input type="file" name="logo" accept="image/*" 
                       class="w-full px-4 py-3 rounded-lg bg-white border border-gray-200 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-purple-50 file:text-purple-700 hover:file:bg-purple-100">
              </div>
                     
            </div>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label class="block text-gray-700 mb-2">Domain*</label>
              <select name="domain" required 
                      class="w-full px-4 py-3 rounded-lg bg-white border border-gray-200 focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                <option value="">Select Domain</option>
                <option>Education</option>
                <option>Environment</option>
                <option>Healthcare</option>
                <option>Technology</option>
                <option>Others</option>
              </select>
            </div>
            <div>
              <label class="block text-gray-700 mb-2">Account Type*</label>
              <select name="account_type" required 
                      class="w-full px-4 py-3 rounded-lg bg-white border border-gray-200 focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                <option value="">Select Type</option>
                <option>Corporate</option>
                <option>NGO</option>
              </select>
            </div>
          </div>

          

          <div class="space-y-4">
            <label class="block text-gray-700 mb-2">Location*</label>
            
            <!-- Coordinates Section -->
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <input type="hidden" id="latitude" name="latitude" required>
                    <input type="hidden" id="longitude" name="longitude" required>
                    <div class="glass-effect p-4 rounded-xl">
                        <p class="text-sm">Selected Coordinates:</p>
                        <p id="coordinatesDisplay" class="font-mono text-purple-600" >Not set</p>
                    </div>
                </div>
                
                <!-- Map Preview -->
                <div id="mapPreview" class="h-20 rounded-xl border-2 border-purple-100"></div>
            </div>
          
            <!-- Location Buttons -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <button type="button" onclick="getCurrentLocation()" 
                        class="w-full glass-effect p-4 rounded-xl hover-scale flex items-center justify-center space-x-2">
                    <i class="fas fa-location-arrow text-purple-600"></i>
                    <span>Use Current Location</span>
                </button>
                
                <div class="flex gap-2">
                    <input type="text" id="addressInput" 
                    
                           class="flex-1 glass-effect p-4 rounded-xl" 
                           placeholder="Enter address">
                    <button type="button" onclick="searchAddress()" 
                            class="glass-effect px-6 rounded-xl hover-scale text-purple-600">
                        <i class="fas fa-search"></i>
                    </button>
                </div>
            </div>
          </div>

          <button type="submit" 
                  class="w-full bg-gradient-to-r from-purple-600 to-indigo-500 text-white py-3 rounded-lg hover:opacity-90 transition-all">
            Create Account
          </button>

          <p class="text-center mt-4 text-gray-600">
            Existing user? 
            <a  href="{{url_for('login')}}" class="text-purple-600 hover:underline">Sign In</button>
          </p>
        </form>
      </div>
    </div>
  </div>

  <script>
    AOS.init({ duration: 1000, once: true });
    // Leaflet Map Initialization
let map;
let marker;

function initMap() {
  map = L.map('mapPreview').setView([20.5937, 78.9629], 5); // Default to India
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; OpenStreetMap contributors'
  }).addTo(map);
  
  map.on('click', function(e) {
      updateLocation(e.latlng.lat, e.latlng.lng);
  });
}

// Get current location
function getCurrentLocation() {
  if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(position => {
          const lat = position.coords.latitude;
          const lng = position.coords.longitude;
          updateLocation(lat, lng);
      }, error => {
          alert("Error getting location: " + error.message);
      });
  } else {
      alert("Geolocation is not supported by this browser");
  }
}

// Address search using Nominatim
function searchAddress() {
  const address = document.getElementById('addressInput').value;
  if (!address) return;

  fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(address)}`)
      .then(response => response.json())
      .then(data => {
          if (data && data.length > 0) {
              const lat = parseFloat(data[0].lat);
              const lon = parseFloat(data[0].lon);
              updateLocation(lat, lon);
          } else {
              alert("Location not found");
          }
      })
      .catch(error => {
          alert("Error searching location: " + error.message);
      });
}

// Update map and fields
function updateLocation(lat, lng) {
  // Update coordinates display
  document.getElementById('coordinatesDisplay').textContent = 
      `${lat.toFixed(6)}, ${lng.toFixed(6)}`;
  
  // Update hidden inputs
  document.getElementById('latitude').value = lat;
  document.getElementById('longitude').value = lng;

  // Update map
  if (marker) map.removeLayer(marker);
  marker = L.marker([lat, lng]).addTo(map);
  map.setView([lat, lng], 14);
}

// Initialize map when document loads
document.addEventListener('DOMContentLoaded', initMap);
  </script>
</div>

{% endblock %}

{% block style %}  
<style>
  /* Same styles as index.html */
  .gradient-text {
      background: linear-gradient(45deg, #6B46C1, #9F7AEA);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
  }
  
  .glass-effect {
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(0, 0, 0, 0.1);
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  }
  
  .hover-scale {
      transition: transform 0.3s ease;
  }
  
  .hover-scale:hover {
      transform: scale(1.05);
  }
</style>
{% endblock %}



